{% extends "eleve/base.html" %}
{% load static %}

{% block title %}Profil | Portail √âl√®ve{% endblock %}
{% block page_title %}Profil{% endblock %}




{% block extra_css %}
<link rel="stylesheet" href="{% static 'eleve/css/profil.css' %}?v=3">
{% endblock %}

{% block extra_js %}
<script defer src="{% static 'eleve/js/profil.js' %}?v=3"></script>
{% endblock %}

{% block content %}

<!-- HERO -->
<div class="card profile-hero2">
  <div class="p2-left">
    <div class="p2-avatar">
      {% if eleve.photo %}
        <img src="{{ eleve.photo.url }}" alt="Photo">
      {% else %}
        <div class="p2-fallback">{{ eleve.prenom|slice:":1" }}{{ eleve.nom|slice:":1" }}</div>
      {% endif %}
    </div>

    <div class="p2-id">
      <div class="p2-pill">
        <span class="dot"></span>
        <div class="kv2-row">
  <span class="k">Matricule</span>
  <span class="v" data-copy="{{ eleve.matricule|default:'‚Äî' }}">{{ eleve.matricule|default:"‚Äî" }}</span>
</div>
        {% if inscription %}
          <span class="sep">‚Ä¢</span>
          <span>{{ inscription.groupe.nom }}</span>
        {% endif %}
      </div>

      <div class="p2-name">{{ eleve.prenom }} {{ eleve.nom }}</div>

      <div class="p2-meta muted">
        {% if inscription %}
          {{ inscription.groupe.niveau.degre.nom }} ‚Ä¢ {{ inscription.groupe.niveau.nom }} ‚Ä¢ {{ inscription.annee.nom }}
        {% else %}
          Aucune inscription active
        {% endif %}
      </div>

      <div class="p2-badges">
        <span class="tag">Sexe: {{ eleve.get_sexe_display|default:"‚Äî" }}</span>
<div class="kv2-row">
  <span class="k">T√©l√©phone</span>
  <span class="v" data-copy="{{ eleve.telephone|default:'‚Äî' }}">{{ eleve.telephone|default:"‚Äî" }}</span>
</div>        {% if inscription %}
          <span class="tag ok">{{ inscription.get_statut_display }}</span>
        {% else %}
          <span class="tag warn">Non inscrit</span>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="p2-right">
<button class="btn primary" type="button" data-open-password-modal>
  üîí Changer mot de passe
</button>
  </div>
</div>

<div class="grid profile-grid2">

  <!-- Infos √âl√®ve -->
  <div class="card">
    <div class="section-head">
      <div>
        <h3 style="margin:0">Informations √©l√®ve</h3>
        <div class="muted">Identit√© & contact</div>
      </div>
    </div>

    <div class="kv2">
      <div class="kv2-row"><span class="k">Matricule</span><span class="v">{{ eleve.matricule|default:"‚Äî" }}</span></div>
      <div class="kv2-row"><span class="k">Nom</span><span class="v">{{ eleve.nom|default:"‚Äî" }}</span></div>
      <div class="kv2-row"><span class="k">Pr√©nom</span><span class="v">{{ eleve.prenom|default:"‚Äî" }}</span></div>
      <div class="kv2-row"><span class="k">Date naissance</span><span class="v">{{ eleve.date_naissance|date:"d/m/Y"|default:"‚Äî" }}</span></div>
      <div class="kv2-row"><span class="k">T√©l√©phone</span><span class="v">{{ eleve.telephone|default:"‚Äî" }}</span></div>
      <div class="kv2-row"><span class="k">Adresse</span><span class="v">{{ eleve.adresse|default:"‚Äî" }}</span></div>
    </div>
  </div>

  <!-- Scolarit√© -->
  <div class="card">
    <div class="section-head">
      <div>
        <h3 style="margin:0">Scolarit√©</h3>
        <div class="muted">Ann√©e, niveau & groupe</div>
      </div>
    </div>

    {% if inscription %}
      <div class="kv2">
        <div class="kv2-row"><span class="k">Ann√©e</span><span class="v">{{ inscription.annee.nom }}</span></div>
        <div class="kv2-row"><span class="k">Degr√©</span><span class="v">{{ inscription.groupe.niveau.degre.nom }}</span></div>
        <div class="kv2-row"><span class="k">Niveau</span><span class="v">{{ inscription.groupe.niveau.nom }}</span></div>
        <div class="kv2-row"><span class="k">Groupe</span><span class="v">{{ inscription.groupe.nom }}</span></div>
        <div class="kv2-row">
          <span class="k">Statut</span>
          <span class="v"><span class="tag ok">{{ inscription.get_statut_display }}</span></span>
        </div>
      </div>
    {% else %}
      <div class="empty-state">
        <div class="empty-ic">‚ÑπÔ∏è</div>
        <div>
          <b>Aucune inscription</b>
          <div class="muted">Aucune inscription trouv√©e pour l‚Äôann√©e active.</div>
        </div>
      </div>
    {% endif %}
  </div>

  <!-- ‚úÖ Parents -->
  <div class="card" style="grid-column: span 2;">
    <div class="section-head">
      <div>
        <h3 style="margin:0">Parents / Tuteurs</h3>
        <div class="muted">Contacts li√©s √† l‚Äô√©l√®ve</div>
      </div>
    </div>

    {% if parents %}
      <div class="parents-grid">
        {% for pe in parents %}
          <div class="parent-card">
            <div class="parent-top">
              <div class="parent-avatar">
                {{ pe.parent.prenom|slice:":1" }}{{ pe.parent.nom|slice:":1" }}
              </div>
              <div class="parent-id">
                <div class="parent-name">{{ pe.parent.prenom }} {{ pe.parent.nom }}</div>
                <div class="muted">{{ pe.get_lien_display }}</div>
              </div>
              <div class="parent-badge">{{ pe.get_lien_display }}</div>
            </div>

            <div class="parent-kv">
<b data-copy="{{ pe.parent.telephone|default:'‚Äî' }}">{{ pe.parent.telephone|default:"‚Äî" }}</b>
              <div><span>Email</span><b>{{ pe.parent.email|default:"‚Äî" }}</b></div>
              <div class="full"><span>Adresse</span><b>{{ pe.parent.adresse|default:"‚Äî" }}</b></div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted">Aucun parent/tuteur li√©.</p>
    {% endif %}
  </div>

</div>
{% endblock %}
