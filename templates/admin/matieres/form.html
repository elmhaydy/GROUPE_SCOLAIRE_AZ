{% extends "admin/base_admin.html" %}
{% load static %}

{% block title %}Matière | AZ{% endblock %}
{% block page_title %}Matière{% endblock %}
{% block current_page %}Pédagogie / Matières{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css">
<link rel="stylesheet" href="{% static 'admin/css/matieres/form.css' %}?v=999">
{% endblock %}

{% block content %}

<div class="az-matiere-card">

  <div class="az-matiere-head">
    <div>
      <h3 class="az-matiere-title">
        {% if mode == "create" %}Ajouter{% else %}Modifier{% endif %} une matière
      </h3>
      <p class="az-matiere-sub">Gestion moderne des matières (niveaux + enseignants) avec recherche rapide.</p>
    </div>

    <span class="az-badge">
      <i class="fas fa-layer-group"></i>
      {% if mode == "create" %}Création{% else %}Édition{% endif %}
    </span>
  </div>

  {% if form.non_field_errors %}
    <div class="az-msg az-msg--error">
      {% for e in form.non_field_errors %}
        <div>{{ e }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <form method="post" class="az-matiere-form" novalidate>
    {% csrf_token %}

    <div class="az-section">
      <div class="az-section-head">
        <div>
          <h4 class="az-section-title"><i class="fas fa-circle-info"></i> Informations</h4>
          <p class="az-section-sub">Nom, code, coefficient et statut.</p>
        </div>
      </div>

      <div class="az-grid-2">
        <div class="az-field">
          <label for="{{ form.nom.id_for_label }}">{{ form.nom.label }}</label>
          {{ form.nom }}
          {% if form.nom.help_text %}<div class="az-help">{{ form.nom.help_text }}</div>{% endif %}
          {% if form.nom.errors %}
            <div class="az-err">
              {% for e in form.nom.errors %}<div>{{ e }}</div>{% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="az-field">
          <label for="{{ form.code.id_for_label }}">{{ form.code.label }}</label>
          {{ form.code }}
          {% if form.code.help_text %}<div class="az-help">{{ form.code.help_text }}</div>{% endif %}
          {% if form.code.errors %}
            <div class="az-err">
              {% for e in form.code.errors %}<div>{{ e }}</div>{% endfor %}
            </div>
          {% endif %}
        </div>
      </div>

      <div class="az-grid-2">
        <div class="az-field">
          <label for="{{ form.coefficient.id_for_label }}">{{ form.coefficient.label }}</label>
          {{ form.coefficient }}
          {% if form.coefficient.errors %}
            <div class="az-err">
              {% for e in form.coefficient.errors %}<div>{{ e }}</div>{% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="az-field az-field-switch">
          <div class="az-switch-row">
            <div class="az-switch-text">
              <div class="az-switch-title">Actif</div>
              <div class="az-switch-sub">Désactive la matière sans la supprimer.</div>
            </div>
            <label class="az-switch">
              {{ form.is_active }}
              <span class="az-switch-ui" aria-hidden="true"></span>
            </label>
          </div>
          {% if form.is_active.errors %}
            <div class="az-err">
              {% for e in form.is_active.errors %}<div>{{ e }}</div>{% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="az-section">
      <div class="az-section-head">
        <div>
          <h4 class="az-section-title"><i class="fas fa-layer-group"></i> Affectations</h4>
          <p class="az-section-sub">Choisir niveaux et enseignants (recherche activée).</p>
        </div>
      </div>

      <div class="az-grid-2">
        <div class="az-field">
          <label for="{{ form.niveaux.id_for_label }}">{{ form.niveaux.label }}</label>
          {{ form.niveaux }}
          {% if form.niveaux.errors %}
            <div class="az-err">
              {% for e in form.niveaux.errors %}<div>{{ e }}</div>{% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="az-field">
          <label for="{{ form.enseignants.id_for_label }}">{{ form.enseignants.label }}</label>
          {{ form.enseignants }}
          {% if form.enseignants.errors %}
            <div class="az-err">
              {% for e in form.enseignants.errors %}<div>{{ e }}</div>{% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="az-matiere-actions az-matiere-actions--sticky">
      <div class="az-actions-left">
        <a class="az-btn az-btn-soft" href="{% url 'core:matiere_list' %}">
          <i class="fas fa-arrow-left"></i> Retour
        </a>

        {% if mode != "create" and matiere %}
          <a class="az-btn az-btn-ghost az-btn-danger"
             href="{% url 'core:matiere_delete' matiere.id %}"
             title="Supprimer la matière">
            <i class="fas fa-trash"></i> Supprimer
          </a>
        {% endif %}
      </div>

      <div class="az-actions-right">
        <button class="az-btn az-btn-gradient" type="submit">
          <i class="fas fa-save"></i> Enregistrer
        </button>
      </div>
    </div>

  </form>
</div>

{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>
<script src="{% static 'admin/js/matieres/form.js' %}?v=999"></script>
{% endblock %}
