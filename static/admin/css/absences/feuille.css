/* =========================================================
   AZ NEBULA — Feuille de présence (FINAL)
   - Dark/Light via html[data-theme]
   - Statut "3 boutons" ultra pratique
   ========================================================= */

.az-presence{ grid-column: span 12; }
.az-presence-card{
  max-width: 1200px;
  margin: 0 auto;
  overflow: hidden;
}

/* ===== Head ===== */
.az-presence-head{
  display:flex;
  justify-content:space-between;
  gap: 16px;
  flex-wrap:wrap;
  padding-bottom: 14px;
  border-bottom: 1px solid var(--az-border);
  margin-bottom: 14px;
}

.az-presence-title{
  margin:0;
  display:flex;
  align-items:center;
  gap:10px;
}

.az-presence-seance{ margin-top: 6px; }

.az-loading{
  opacity:.75;
  display:inline-flex;
  align-items:center;
  gap:10px;
}
.az-loading::after{
  content:"";
  width: 10px; height: 10px;
  border-radius: 50%;
  border: 2px solid rgba(99,102,241,.35);
  border-top-color: rgba(99,102,241,.95);
  animation: az-spin .8s linear infinite;
}

/* ===== Counters ===== */
.az-counters{
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  margin-top: 12px;
}
.az-counter{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(148,163,184,.25);
  background: linear-gradient(180deg, var(--az-bg-secondary), var(--az-bg-primary));
  min-width: 160px;
  box-shadow: var(--az-shadow-sm);
}
.az-counter span{
  display:inline-flex;
  align-items:center;
  gap:10px;
  font-weight: 800;
  color: var(--az-text-secondary);
}
.az-counter b{
  font-size: 1.05rem;
  font-weight: 900;
  color: var(--az-text-primary);
}

.az-counter--ok b{ color: var(--az-success, #10b981); }
.az-counter--danger b{ color: var(--az-danger, #ef4444); }
.az-counter--warn b{ color: var(--az-warning, #f59e0b); }

html[data-theme="dark"] .az-counter{
  background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  border-color: rgba(148,163,184,.18);
}

/* ===== Head actions ===== */
.az-presence-head-actions{
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  align-items:center;
}

/* ===== Toolbar ===== */
.az-presence-toolbar{
  display:flex;
  align-items:center;
  gap: 12px;
  flex-wrap:wrap;
  padding: 12px;
  border-radius: 18px;
  border: 1px solid var(--az-border);
  background: linear-gradient(180deg, var(--az-bg-secondary), var(--az-bg-primary));
  box-shadow: var(--az-shadow-sm);
  margin-bottom: 12px;
}

html[data-theme="dark"] .az-presence-toolbar{
  background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
}

/* Bulk */
.az-bulk{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

/* Search */
.az-search{
  flex: 1;
  min-width: 260px;
  position: relative;
}
.az-search i{
  position:absolute;
  left: 14px;
  top: 50%;
  transform: translateY(-50%);
  opacity: .65;
}
.az-search .az-input{
  width:100%;
  padding-left: 40px;
}

/* ===== Table ===== */
.az-tablewrap{
  overflow:auto;
  border-radius: 18px;
  border: 1px solid var(--az-border);
  background: var(--az-bg-primary);
}
html[data-theme="dark"] .az-tablewrap{
  background: rgba(2,6,23,.18);
  border-color: rgba(148,163,184,.18);
}

.az-table-presence{
  width: 100%;
  border-collapse: collapse;
}
.az-table-presence thead th{
  padding: 14px 14px;
  font-size: .78rem;
  text-transform: uppercase;
  letter-spacing: .08em;
  color: var(--az-text-tertiary);
  background: var(--az-bg-secondary);
  border-bottom: 1px solid var(--az-border);
}
html[data-theme="dark"] .az-table-presence thead th{
  background: rgba(255,255,255,.03);
  border-bottom-color: rgba(148,163,184,.18);
}

.az-tr{
  border-bottom: 1px solid rgba(148,163,184,.16);
}
.az-td{
  padding: 14px 14px;
  vertical-align: middle;
  color: var(--az-text-secondary);
}
.az-td strong{ color: var(--az-text-primary); }

.az-row-e{
  display:flex;
  flex-direction:column;
  gap: 2px;
}
.az-row-e .az-sub{ opacity:.78; }

/* Loading row */
.az-loading-row{
  padding: 30px !important;
  text-align:center;
  color: var(--az-text-secondary);
}
.az-spinner{
  width: 18px; height: 18px;
  border-radius: 50%;
  border: 2px solid rgba(148,163,184,.25);
  border-top-color: rgba(99,102,241,.9);
  margin: 0 auto 10px;
  animation: az-spin .8s linear infinite;
}

/* ===== MSG AREA ===== */
.az-msg-area{ margin: 10px 0 0; min-height: 8px; }
.az-msg{
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(148,163,184,.22);
  background: rgba(255,255,255,.04);
  color: var(--az-text-secondary);
  margin-bottom: 10px;
}
.az-msg.ok{
  border-color: rgba(16,185,129,.25);
  background: rgba(16,185,129,.10);
  color: rgba(16,185,129,.95);
}
.az-msg.bad{
  border-color: rgba(239,68,68,.25);
  background: rgba(239,68,68,.10);
  color: rgba(239,68,68,.95);
}

/* =========================================================
   STATUT — 3 BOUTONS (PRATIQUE)
   ========================================================= */
.az-status{
  display:flex;
  gap:10px;
  align-items:center;
  justify-content:flex-start;
  flex-wrap:wrap;
}

.az-status-in{
  position:absolute;
  opacity:0;
  pointer-events:none;
  width:1px;height:1px;
}

.az-status-btn{
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding: 10px 14px;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,.30);
  background: rgba(255,255,255,.04);
  color: var(--az-text-secondary);
  cursor:pointer;
  user-select:none;
  transition: var(--az-transition-fast);
  font-weight: 900;
  min-width: 120px;
  justify-content:center;
}

html[data-theme="dark"] .az-status-btn{
  background: rgba(255,255,255,.03);
  border-color: rgba(148,163,184,.18);
  color: rgba(226,232,240,.90);
}

.az-status-btn:hover{
  transform: translateY(-1px);
  border-color: rgba(99,102,241,.55);
  box-shadow: 0 10px 22px rgba(0,0,0,.18);
}

/* Checked state */
.az-status-in:checked + .az-status-btn{
  border-color: rgba(99,102,241,.80);
  background: rgba(99,102,241,.14);
  color: #fff;
  box-shadow:
    0 0 0 4px rgba(99,102,241,.18),
    0 12px 26px rgba(99,102,241,.10);
}

/* Per state colors */
.az-status-in:checked + .az-status-btn.is-present{
  border-color: rgba(16,185,129,.75);
  background: rgba(16,185,129,.16);
  box-shadow:
    0 0 0 4px rgba(16,185,129,.18),
    0 14px 28px rgba(16,185,129,.10);
}
.az-status-in:checked + .az-status-btn.is-absent{
  border-color: rgba(239,68,68,.75);
  background: rgba(239,68,68,.16);
  box-shadow:
    0 0 0 4px rgba(239,68,68,.18),
    0 14px 28px rgba(239,68,68,.10);
}
.az-status-in:checked + .az-status-btn.is-retard{
  border-color: rgba(245,158,11,.75);
  background: rgba(245,158,11,.16);
  box-shadow:
    0 0 0 4px rgba(245,158,11,.18),
    0 14px 28px rgba(245,158,11,.10);
}

/* ===== Responsive ===== */
@media (max-width: 900px){
  .az-counter{ min-width: 150px; }
  .az-status-btn{ min-width: 110px; padding: 10px 12px; }
}

@media (max-width: 640px){
  .az-presence-head{ flex-direction:column; align-items:flex-start; }
  .az-presence-head-actions{ width:100%; }
  .az-presence-head-actions .az-btn{ width:auto; }
  .az-search{ min-width: 100%; }
}

@keyframes az-spin{ to { transform: rotate(360deg); } }

/* Print */
@media print{
  .az-presence-toolbar,
  .az-presence-head-actions,
  #btn_save{ display:none !important; }
  .az-card{ box-shadow:none !important; border:1px solid #ddd !important; }
}
